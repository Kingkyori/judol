(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[797],{103:function(e,a,n){Promise.resolve().then(n.bind(n,2271))},2271:function(e,a,n){"use strict";n.r(a),n.d(a,{default:function(){return c}});var t=n(7437),s=n(2265),l=n(231),i=n.n(l);function c(){let[e,a]=(0,s.useState)(null),[n,l]=(0,s.useState)(null),[c,r]=(0,s.useState)(!1),o=(0,s.useMemo)(()=>["7","♣","♥","♦","★","\uD83C\uDF52","\uD83D\uDD14","\uD83C\uDF4B"],[]),d=1200*o.length,[u,m]=(0,s.useState)([0,0,0]),[h,f]=(0,s.useState)(["none","none","none"]),j=(0,s.useRef)([]),[p,N]=(0,s.useState)(null),[v,x]=(0,s.useState)(!1);async function g(){if(c)return;l(null),N(null),r(!0);let e=Date.now(),a=[1600,1900,2200],n=[1100,1200,1300];f(["none","none","none"]);let t=[e,e,e],s=s=>{let l=()=>{let i=Date.now(),c=(i-t[s])/1e3;t[s]=i;let r=Math.min(1,(i-e)/a[s]);m(e=>{let a=[...e],t=a[s]+n[s]*c;return a[s]=Math.min(t,d-120),a}),r<1&&(j.current[s]=requestAnimationFrame(l))};j.current[s]=requestAnimationFrame(l)};s(0),s(1),s(2);try{var i;let e=await fetch("/api/simulate",{method:"POST"}),n=e.ok?await e.json():null,t=o.length,s=Math.floor(Math.random()*t),c=[s,(s+1)%t,(s+3)%t],h=null!==(i=null==n?void 0:n.outcome)&&void 0!==i?i:"LOSE";"WIN"===h&&(c=[s,s,s]);let p=e=>{let a=u[e],n=120*c[e],s=120*t,l=[];for(let e=0;e<10;e++)l.push(n+e*s);let i=l.filter(e=>e>=a),r=i.length?Math.min(...i):n;f(a=>{let n=[...a];return n[e]="transform 420ms cubic-bezier(0.22, 1, 0.36, 1)",n}),m(a=>{let n=[...a];return n[e]=Math.min(r,d-120),n}),j.current[e]&&cancelAnimationFrame(j.current[e])};a.forEach((e,a)=>{setTimeout(()=>p(a),e+50)}),setTimeout(()=>{l(n),"WIN"===h?(N("Selamat! Anda MENANG."),x(!0),setTimeout(()=>x(!1),1500)):"LOSE"===h?N("Maaf, Anda KALAH."):"DISABLED"===h&&N("Jackpot sedang tidak aktif."),r(!1)},Math.max(...a)+500)}catch(e){r(!1)}}return(0,s.useEffect)(()=>{(async()=>{try{let e=await fetch("/api/settings",{cache:"no-store"});e.ok&&a(await e.json())}catch(e){}})()},[]),(0,t.jsx)("div",{className:"container",children:(0,t.jsxs)("div",{className:"card",children:[(0,t.jsx)("div",{className:"hero-title",children:"Mesin Jackpot"}),(0,t.jsx)("div",{className:"hero-subtitle",children:"Coba keberuntungan Anda, lihat dampak dari pengaturan Admin secara langsung."}),e?(0,t.jsxs)("div",{className:"grid-two",style:{marginTop:16},children:[(0,t.jsxs)("div",{style:{justifySelf:"center"},children:[(0,t.jsxs)("div",{className:"slot-wrap",children:[(0,t.jsx)("div",{className:"slot ".concat((null==n?void 0:n.outcome)==="WIN"?"win":(null==n?void 0:n.outcome)==="LOSE"?"lose":""),role:"img","aria-label":"Mesin slot 3 reel",children:[0,1,2].map(e=>(0,t.jsx)("div",{className:"reel ".concat(c?"spinning":""),children:(0,t.jsx)("div",{className:"symbols",style:{transform:"translateY(-".concat(u[e],"px)"),transition:h[e]},children:Array.from({length:10}).flatMap(()=>o).map((a,n)=>(0,t.jsx)("div",{className:"symbol",children:a},e+"-"+n))})},e))}),v&&(0,t.jsx)("div",{className:"confetti","aria-hidden":!0,children:Array.from({length:14}).map((e,a)=>(0,t.jsx)("span",{className:"confetti-piece",style:{left:"".concat(7*a%100,"%"),background:["#ef4444","#22c55e","#3b82f6","#f59e0b"][a%4]}},a))})]}),(0,t.jsxs)("div",{style:{display:"flex",gap:12,marginTop:14,justifyContent:"center"},children:[(0,t.jsx)("button",{className:"btn btn-primary",onClick:g,disabled:c,children:c?"Memutar…":"Spin"}),(0,t.jsx)(i(),{className:"btn btn-ghost",href:"/",children:"Beranda"})]}),(null==n?void 0:n.outcome)&&(0,t.jsx)("div",{className:"badge ".concat("WIN"===n.outcome?"win":"LOSE"===n.outcome?"lose":"info"),style:{marginTop:10,justifySelf:"center"},children:"WIN"===n.outcome?"MENANG":"LOSE"===n.outcome?"KALAH":"DISABLED"===n.outcome?"NONAKTIF":n.outcome}),p&&(0,t.jsx)("div",{className:"notice",style:{marginTop:10},"aria-live":"polite",children:p})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"stat-list",children:[(0,t.jsxs)("div",{className:"stat",children:[(0,t.jsx)("span",{children:"\uD83D\uDCA1"}),(0,t.jsx)("div",{className:"label",children:"Jackpot Aktif"}),(0,t.jsx)("div",{className:"value",children:e.jackpotEnabled?"Ya":"Tidak"})]}),(0,t.jsxs)("div",{className:"stat",children:[(0,t.jsx)("span",{children:"\uD83C\uDFAF"}),(0,t.jsx)("div",{className:"label",children:"Izinkan Menang"}),(0,t.jsx)("div",{className:"value",children:e.allowWin?"Ya":"Tidak"})]}),(0,t.jsxs)("div",{className:"stat",children:[(0,t.jsx)("span",{children:"\uD83D\uDCC8"}),(0,t.jsx)("div",{className:"label",children:"Presentase Jackpot"}),(0,t.jsx)("div",{className:"value",children:e.jackpotPercent})]})]}),(0,t.jsx)("div",{className:"card",style:{marginTop:12},children:(0,t.jsx)("p",{children:"Tekan tombol untuk mencoba spin. Hasil akan mengikuti pengaturan dari Admin."})})]})]}):(0,t.jsx)("p",{style:{marginTop:12},children:"Memuat pengaturan…"})]})})}}},function(e){e.O(0,[231,971,23,744],function(){return e(e.s=103)}),_N_E=e.O()}]);